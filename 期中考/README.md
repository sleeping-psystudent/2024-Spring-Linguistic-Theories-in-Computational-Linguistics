# 2024 計算語言學與語言理論期中考
##### Computational Linguistics and Linguistic Theories (mid-term exam)

## 第一題 (10%)

 ➡️ 在課本中第四章的式子 (4.14) 中，提到了 `Laplace` smoothing。請以 **markdown** 的語法，寫出這個式子，並解釋分母為何變成加 $|V|$。

 ## 第二題 (20%)

 ➡️ 在課本中 3.9 小節中討論了 Perplexity 和 Entropy 的關聯。請用你理解的方式，重新摘要簡述 (rephrase) 一次。

 ## 第三題 (50%)
##### 梯度下降在自然語言處理中的應用

在自然語言處理中，梯度下降（Gradient Descent）是一種廣泛使用的優化算法，用於最小化模型的損失函數，從而找到模型參數的最佳值。梯度下降通過計算損失函數對參數的梯度，並在梯度的反方向上調整參數值來進行優化。這一過程持續迭代，直到達到某個停止條件（如梯度接近0、達到最大迭代次數或損失低於某個閾值等）。

### 3.1 (20%)

 ➡️  假設你正在使用一個簡單的線性模型來預測基於詞向量的文本情感分析的結果。模型的損失函數是均方誤差（MSE），定義為：

$$
MSE = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
$$

其中 $n$ 是樣本數量 $y_i$ 是第 $i$ 個樣本的真實情感值 $\hat{y}_i$ 是模型預測的情感值，預測值 $\hat{y}$ 由下式給出：

$$
\hat{y}_i = wx_i + b
$$

其中 $w$ 是模型權重 $b$ 是偏差項， $x_i$ 是第 $i$ 個樣本的詞向量。

1. **推導梯度下降更新公式**：給定上述模型和損失函數，推導應用梯度下降法更新 $w$ 和 $b$ 的公式。請展示完整的推導過程。

2. **應用情景分析**：在實際應用中，選擇學習率（learning rate）對梯度下降算法的性能有重要影響。請討論學習率過大和過小對模型訓練過程的可能影響，並提出如何選擇合適學習率的方法。

3. **擴展問題**：在某些情況下，標準梯度下降算法可能不是最佳選擇。請討論至少兩種梯度下降的變體（例如`Stochastic Gradient Descent`、`Mini-batch training` 等），並比較它們與標準梯度下降在計算效率和收斂速度方面的優缺點。

#### 注意

- 答題時請清晰地標示每一步的計算過程和推理邏輯。

- 對於第3小題的擴展問題，除了文字描述外，如果可能，請給出相關演算法的 pseudo code 以輔助解釋。

### 3.2 (30%)

 ➡️ 使用 Naïve Bayes 模型和 TF-IDF 特徵對評論進行情感分析（正面或負面），並用梯度下降算法來優化一個簡單的線性回歸模型。

數據集：使用 `scikit-learn` 中的 `fetch_20newsgroups` 數據集作為例子，從中選取兩個類別作為正面和負面評論的代表。

- 步驟：

  - 載入和前處理數據。
  - 使用 TF-IDF 進行文本特徵提取。
  - 實作 NB 模型訓練情感分類器，並計算正確率(accuracy)。
  - 用梯度下降算法優化線性回歸模型。


⚠️⚠️ 請注意，梯度下降實作在實際應用中，特別是對於大規模數據集和複雜模型，我們通常使用更高級的優化算法和框架（如TensorFlow 或 PyTorch）來實現。這裡不需要使用框架。使用 `sklearn`即可。

## 第四題 (20%)

請利用賽考利克泰雅語語料（`atayal.csv`）

➡️ 進行前處理

➡️ 為每個詞產生一組 fasttext word embeddings (via `gensim` FastText)


---


⚠️⚠️ 前處理：大寫轉小寫、以空格斷詞(tokenize)

⚠️⚠️ 泰雅語的`'`是聲門塞音 (glottal stop)，它會造成**語意差別** (e.g. kya' vs. kya)，前處理時需注意不可將它清除。

⚠️⚠️ 你的 output 需要包含：

- Fasttext word embedding matrix
    - 請使用下方設定的參數來 define model
    - 請輸出 **完整的 df**

---

## 加分題 (bonus, 30%)

> 可以回家寫，下週上課繳交。

### 加分題 1

➡️ (15%) 使用 [K-means clustering](https://www.wikiwand.com/en/K-means_clustering) 進行詞彙分類及畫圖（可以自行決定 cluster 的數量以及降維方式）

   - 請以 scatter plot 呈現，每個 cluster 以**不同顏色**標記
   - 每一點需標上**對應詞彙**的文字
   - 描述並分析你在詞彙 cluster plot 觀察到的現象。例如描述並分析圖中每個 cluster 包含哪些詞彙、這些詞彙有沒有語意關聯等等 ...（請使用以下所附的參考資源）

### 加分題2  
➡️ (15%)    
  
> t-SNE（t-distributed Stochastic Neighbor Embedding）和 UMAP（Uniform Manifold Approximation and Projection）都是降維技術，廣泛應用於高維數據的視覺化。它們能夠將高維數據點映射到低維空間（通常是二維或三維），以便於視覺化和分析。

➡️ 研究一下對於前面的數據使用 `t-SNE` 與 `UMAP` 視覺化，做個比較，給出你的觀察與想法。
